<!DOCTYPE html>
<html>
<head>
  <title>Iteration with recursion</title>
  <meta charset="utf-8">
  <link rel="stylesheet" type="text/css" href="style.css"/>
</head>
<body>
<textarea id="source">

background-image: url(img/fp-tower/website-background.svg)

class: center, middle, white

.title[Iteration with recursion]

---
# Generate n random numbers

<br>

```scala
import scala.util.Random

def randomNumbers(length: Int): List[Int] =
  if(length <= 0) Nil
  else {
    val number = Random.nextInt(100)
    number :: randomNumbers(length - 1)
  }
```

```scala
randomNumbers(2)
// res0: List[Int] = List(88, 29)
randomNumbers(5)
// res1: List[Int] = List(30, 49, 89, 93, 98)
randomNumbers(-1)
// res2: List[Int] = List()
```

---
# Termination conditions

<br>

```scala
import scala.util.Random

def randomNumbers(length: Int): List[Int] =
  if(length == 0) Nil
  else {
    val number = Random.nextInt(100)
    number :: randomNumbers(length - 1)
  }
```

```scala
randomNumbers(2)
// res4: List[Int] = List(52, 0)
```

```scala
randomNumbers(-1)
// error: java.lang.StackOverflowError
```

---
# Termination conditions

.fifty-two-left[
```scala
import scala.util.Random

def randomNumbers(length: Int): List[Int] =
  if(length == 0) Nil
  else {
    val number = Random.nextInt(100)
    number :: randomNumbers(length - 1)
  }
```

```scala
randomNumbers(2)
// res6: List[Int] = List(68, 12)
```

```scala
randomNumbers(-1)
// error: java.lang.StackOverflowError
```
]

.forty-two-right[
## Infinite recursion

```scala
def doSomething: String = doSomething
```

```scala
def doSomething: String = {
  while(true) { /* do nothing */ }
  ???
}
```
]

---
# Generalise with Function0

<br>


```scala
def repeat[A](length: Int, action: () => A): List[A] =
  if(length <= 0) Nil
  else {
    val result = action()
    result :: repeat(length - 1, action)
  }
```

--

```scala
repeat(5, () => Random.nextInt(100))
// res8: List[Int] = List(94, 75, 57, 7, 0)

repeat(2, () => println("Hello"))
// Hello
// Hello
// res9: List[Unit] = List((), ())
```

---
# Generalise with call-by-name parameter

<br>


```scala
def repeat[A](length: Int, action: => A): List[A] =
  if(length <= 0) Nil
  else {
    val result = action
    result :: repeat(length - 1, action)
  }
```

```scala
repeat(5, Random.nextInt(100))
// res11: List[Int] = List(31, 47, 63, 94, 28)

repeat(2, println("Hello"))
// Hello
// Hello
// res12: List[Unit] = List((), ())
```

---
# Generalise with call-by-name parameter

<br>


```scala
def repeat[A](length: Int, action: => A): List[A] =
  if(length <= 0) Nil
  else
    action :: repeat(length - 1, action)
```

<br>

```scala
repeat(5, Random.nextInt(100))
// res14: List[Int] = List(23, 94, 93, 30, 8)

repeat(2, println("Hello"))
// Hello
// Hello
// res15: List[Unit] = List((), ())
```

---
# Retry

<br>

```scala
import scala.util.{Try, Success, Failure}

def retry[A](remainingRetries: Int, action: => A): A =
  Try(action) match {
    case Success(value)     => value
    case Failure(exception) =>
      if(remainingRetries <= 0) throw exception
      else retry(remainingRetries - 1, action)
  }
```

---
# Recursive data structure

* List
* Tree: JSON, file system
* case class Person(name: String, children: List[Person])

---
# Problems with recursions

<br>

to understand what is recursion, we need to first understand recursion

```scala
def doSomething: String = doSomething
```

```scala
def doSomething: String = {
  while(true) { /* do nothing */ }
  ???
}
```

---
# Disk Usage

.forty-two-left[
<br><br>
```bash
sbt new scala/scala-seed.g8
cd scala-seed-project
```

<br>

```scala
diskUsage(".")
```
]

.fifty-seven-right[.center[
<img src="img/foundation/scala-seed-project.svg" alt="Scala seed project disk usage" style="width:500px;"/>
]]



---
# Disk Usage

<br>
.forty-two-left[
<br>
```scala
diskUsage(".") =
  diskUsage(".gitignore") +
  diskUsage("build.sbt")  +
  diskUsage("project")    +
  diskUsage("src")
```
]

.fifty-seven-right[.center[
<img src="img/foundation/scala-seed-project-2.svg" alt="Scala seed project disk usage" style="width:500px;"/>
]]

---
# Disk Usage

<br>
.forty-two-left[
<br>
```scala
diskUsage(".") =
  4 Kb + // diskUsage(".gitignore")
  4 Kb + // diskUsage("build.sbt")
  diskUsage("project") +
  diskUsage("src")
```
]

.fifty-seven-right[.center[
<img src="img/foundation/scala-seed-project-2.svg" alt="Scala seed project disk usage" style="width:500px;"/>
]]

---
# Disk Usage

<br>

.fifty-two-left[
<br>
```scala
diskUsage("project") =
  diskUsage("project/Dependencies.scala") +
  diskUsage("project/build.properties")   +
  diskUsage("project/plugin.sbt")
```
]

.forty-seven-right[.center[
<img src="img/foundation/scala-seed-project-3.svg" alt="Scala seed project disk usage" style="width:400px;"/>
]]

---
# Disk Usage

<br>

.fifty-two-left[
<br>
```scala
diskUsage("project") =
  4 Kb + // diskUsage("project/Dependencies.scala")
  4 Kb + // diskUsage("project/build.properties")
  4 Kb   // diskUsage("project/plugin.sbt")
```
]

.forty-seven-right[.center[
<img src="img/foundation/scala-seed-project-3.svg" alt="Scala seed project disk usage" style="width:400px;"/>
]]

---
# Disk Usage

.forty-two-left[
<br><br>
```scala
diskUsage(".") =
   4 Kb + // diskUsage(".gitignore")
   4 Kb + // diskUsage("build.sbt")
  12 Kb + // diskUsage("project")
  diskUsage("src")
```
]

.fifty-seven-right[.center[
<img src="img/foundation/scala-seed-project.svg" alt="Scala seed project disk usage" style="width:500px;"/>
]]

---
# Disk Usage

.forty-two-left[
<br><br>
```scala
diskUsage(".") =
   4 Kb + // diskUsage(".gitignore")
   4 Kb + // diskUsage("build.sbt")
  12 Kb + // diskUsage("project")
   8 Kb   // diskUsage("src")
```
]

.fifty-seven-right[.center[
<img src="img/foundation/scala-seed-project.svg" alt="Scala seed project disk usage" style="width:500px;"/>
]]

---
# Recursion

.thirty-seven-left[
<br>
```scala
def sum(numbers: List[Int]): Int =
  numbers match {
    case Nil =>
      0
    case head :: tail =>
      head + sum(tail)
  }
```
]

.fifty-seven-right[
<img src="img/foundation/recursion-sum-1.svg" alt="Sum with recursion" style="width:450px;"/>
]

---
# Recursion

.thirty-seven-left[
<br>
```scala
def sum(numbers: List[Int]): Int =
  numbers match {
    case Nil =>
      0
    case head :: tail =>
      head + sum(tail)
  }
```
]

.fifty-seven-right[
<img src="img/foundation/recursion-sum-2.svg" alt="Sum with recursion" style="width:600px;"/>
]

---
# Recursion

.thirty-seven-left[
<br>
```scala
def sum(numbers: List[Int]): Int =
  numbers match {
    case Nil =>
      0
    case head :: tail =>
      head + sum(tail)
  }
```
]

.fifty-seven-right[
<img src="img/foundation/recursion-sum-3.svg" alt="Sum with recursion" style="width:600px;"/>
]

---
# Recursion

.thirty-seven-left[
<br>
```scala
def sum(numbers: List[Int]): Int =
  numbers match {
    case Nil =>
      0
    case head :: tail =>
      head + sum(tail)
  }
```
]

.fifty-seven-right[
<img src="img/foundation/recursion-sum-4.svg" alt="Sum with recursion" style="width:600px;"/>
]

---
# Recursion

.thirty-seven-left[
<br>
```scala
def sum(numbers: List[Int]): Int =
  numbers match {
    case Nil =>
      0
    case head :: tail =>
      head + sum(tail)
  }
```
]

.fifty-seven-right[
<img src="img/foundation/recursion-sum-5.svg" alt="Sum with recursion" style="width:600px;"/>
]

---
# Recursion

.thirty-seven-left[
<br>
```scala
def sum(numbers: List[Int]): Int =
  numbers match {
    case Nil =>
      0
    case head :: tail =>
      head + sum(tail)
  }
```

```scala
sum(List())
// res23: Int = 0
```
]

.fifty-seven-right[
<img src="img/foundation/recursion-sum-6.svg" alt="Sum with recursion" style="width:600px;"/>
]

---
# Recursion

.thirty-seven-left[
<br>
```scala
def sum(numbers: List[Int]): Int =
  numbers match {
    case Nil =>
      0
    case head :: tail =>
      head + sum(tail)
  }
```
]

.fifty-seven-right[
<img src="img/foundation/recursion-sum-7.svg" alt="Sum with recursion" style="width:600px;"/>
]


</textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>
    var slideshow = remark.create({
        ratio: "16:9",
        slideNumberFormat: ''
    });
</script>
</body>
</html>